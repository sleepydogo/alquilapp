<head>
  <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
  <%= stylesheet_link_tag 'bootstrap', "map" %>  
  <title>Home</title>
  <link href='https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.css' rel='stylesheet' />    
</head>
<body>
  <div class="container-fluid">
    <% if (current_user.A_Verificar?) %>
      <p style="color: black"><strong>Su usuario no se encuentra validado por lo que no tendrá disponibles todas las funcionalidades de la aplicación</strong></p>
    <% end %>
    <h1 class="mt-4">Bienvenido a Alquilapp</h1>
    <p>Somos un emprendimiento de La Plata, bla bla blabla bla blabla bla blabla bla blabla bla blabla bla blabla bla blabla bla blabla bla blabla bla blas</p>
    <p>Si su cuenta es nueva recibe media hora gratis bla blabla blabla blabla blabla blabla blabla blabla bla</p>
    <div class="row">
    <div class="col-6 offset-3">
        <div class="card mb-3">
          <div class="card-body mb-4">
            <div id="map-container">
              <div id="map">
              </div>
            </div>
          </div>
      </div>
   </div>
</div>

    
  <!-- Map box-->
  <script src='https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.js'></script>
  <script>
    mapboxgl.accessToken = 'pk.eyJ1Ijoic2xlZXB5LWRvZ28iLCJhIjoiY2xhMnJsbXg0MGI4YTN3b3cyMjlvdXQyciJ9.p_N4Twz82flqkmbOZkDZhA';

     <% Car.all do |car| %>
      var geojson = {
      type: "FeatureCollection",
      "features": [
         {
             "type": "Feature",
             "properties": {
                 "message": "Foo",
             },
             "geometry": {
                 "type": "Point",
                 "coordinates": [<%= car.lng %>, <%= car.lat %>]
             }
         }
       ]
     };
     
     // add markers to map
     geojson.features.forEach(function(marker) {
      // create a DOM element for the marker
      var el = document.createElement('div');
      el.className = 'marker';
      el.style.backgroundImage = 'https://cdn4.iconfinder.com/data/icons/small-n-flat/24/map-marker-512.png';
      el.style.width = marker.properties.iconSize[0] + 'px';
      el.style.height = marker.properties.iconSize[1] + 'px';
     
     // add marker to map
      new mapboxgl.Marker(el, { offset: 25 })
         .setLngLat(marker.geometry.coordinates)
         .addTo(map);
     });
     
     <% end %>

     var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v9',
      center: [-57.954511, -34.921213],
      zoom: 12
     });
     
     map.addControl(new mapboxgl.NavigationControl());
</script>
</body>
